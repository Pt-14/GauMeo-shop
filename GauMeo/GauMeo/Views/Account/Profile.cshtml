@model GauMeo.Models.ViewModels.ProfileViewModel
@{
    ViewData["Title"] = "Trang cá nhân";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="~/css/theme.css" asp-append-version="true">
<link rel="stylesheet" href="~/css/account.css" asp-append-version="true">
<link rel="stylesheet" href="~/css/account.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />

<div class="profile-container">
    <div class="profile-left">
        <div class="profile-avatar-block">
            <div class="profile-avatar-wrapper">
                @if (!string.IsNullOrEmpty(Model.Avatar))
                {
                    <img src="@Model.Avatar" class="profile-avatar-img" alt="Avatar" id="currentAvatar" />
                }
                else
                {
                    <div class="profile-avatar-img profile-avatar-dynamic">
                        @Model.Email.Substring(0,1).ToUpper()
                    </div>
                }
                <button class="profile-avatar-edit" type="button" id="editAvatarBtn" data-bs-toggle="modal" data-bs-target="#avatarModal">
                    <i class="fas fa-pencil"></i>
                </button>
            </div>
            <div class="profile-username">@Model.FullName</div>
            <div class="profile-section-title active" data-section="profileInfoSection">Thông tin cá nhân</div>
        </div>
        <hr class="profile-divider" />
        <div class="profile-section">
            <div class="profile-section-title" data-section="favoritesSection">Danh sách yêu thích</div>
        </div>
        <hr class="profile-divider" />
        <div class="profile-section">
            <div class="profile-section-title" data-section="ordersSection">Kiểm tra đơn hàng</div>
        </div>
        <hr class="profile-divider" />
        <form asp-action="Logout" asp-controller="Account" method="post" style="margin: 0;">
            <button type="submit" class="user-dropdown-item logoutButton logoutButton--dark" style="width: 100%; border: none; background: none; cursor: pointer; padding: 8px 16px;">
                                    <svg class="doorway" viewBox="0 0 100 100">
                                        <path d="M93.4 86.3H58.6c-1.9 0-3.4-1.5-3.4-3.4V17.1c0-1.9 1.5-3.4 3.4-3.4h34.8c1.9 0 3.4 1.5 3.4 3.4v65.8c0 1.9-1.5 3.4-3.4 3.4z" />
                                        <path class="bang" d="M40.5 43.7L26.6 31.4l-2.5 6.7zM41.9 50.4l-19.5-4-1.4 6.3zM40 57.4l-17.7 3.9 3.9 5.7z" />
                                    </svg>
                                    <svg class="figure" viewBox="0 0 100 100">
                                        <circle cx="52.1" cy="32.4" r="6.4" />
                                        <path d="M50.7 62.8c-1.2 2.5-3.6 5-7.2 4-3.2-.9-4.9-3.5-4-7.8.7-3.4 3.1-13.8 4.1-15.8 1.7-3.4 1.6-4.6 7-3.7 4.3.7 4.6 2.5 4.3 5.4-.4 3.7-2.8 15.1-4.2 17.9z" />
                                        <g class="arm1">
                                            <path d="M55.5 56.5l-6-9.5c-1-1.5-.6-3.5.9-4.4 1.5-1 3.7-1.1 4.6.4l6.1 10c1 1.5.3 3.5-1.1 4.4-1.5.9-3.5.5-4.5-.9z" />
                                            <path class="wrist1" d="M69.4 59.9L58.1 58c-1.7-.3-2.9-1.9-2.6-3.7.3-1.7 1.9-2.9 3.7-2.6l11.4 1.9c1.7.3 2.9 1.9 2.6 3.7-.4 1.7-2 2.9-3.8 2.6z" />
                                        </g>
                                        <g class="arm2">
                                            <path d="M34.2 43.6L45 40.3c1.7-.6 3.5.3 4 2 .6 1.7-.3 4-2 4.5l-10.8 2.8c-1.7.6-3.5-.3-4-2-.6-1.6.3-3.4 2-4z" />
                                            <path class="wrist2" d="M27.1 56.2L32 45.7c.7-1.6 2.6-2.3 4.2-1.6 1.6.7 2.3 2.6 1.6 4.2L33 58.8c-.7 1.6-2.6 2.3-4.2 1.6-1.7-.7-2.4-2.6-1.7-4.2z" />
                                        </g>
                                        <g class="leg1">
                                            <path d="M52.1 73.2s-7-5.7-7.9-6.5c-.9-.9-1.2-3.5-.1-4.9 1.1-1.4 3.8-1.9 5.2-.9l7.9 7c1.4 1.1 1.7 3.5.7 4.9-1.1 1.4-4.4 1.5-5.8.4z" />
                                            <path class="calf1" d="M52.6 84.4l-1-12.8c-.1-1.9 1.5-3.6 3.5-3.7 2-.1 3.7 1.4 3.8 3.4l1 12.8c.1 1.9-1.5 3.6-3.5 3.7-2 0-3.7-1.5-3.8-3.4z" />
                                        </g>
                                        <g class="leg2">
                                            <path d="M37.8 72.7s1.3-10.2 1.6-11.4 2.4-2.8 4.1-2.6c1.7.2 3.6 2.3 3.4 4l-1.8 11.1c-.2 1.7-1.7 3.3-3.4 3.1-1.8-.2-4.1-2.4-3.9-4.2z" />
                                            <path class="calf2" d="M29.5 82.3l9.6-10.9c1.3-1.4 3.6-1.5 5.1-.1 1.5 1.4.4 4.9-.9 6.3l-8.5 9.6c-1.3 1.4-3.6 1.5-5.1.1-1.4-1.3-1.5-3.5-.2-5z" />
                                        </g>
                                    </svg>
                                    <svg class="door" viewBox="0 0 100 100">
                                        <path d="M93.4 86.3H58.6c-1.9 0-3.4-1.5-3.4-3.4V17.1c0-1.9 1.5-3.4 3.4-3.4h34.8c1.9 0 3.4 1.5 3.4 3.4v65.8c0 1.9-1.5 3.4-3.4 3.4z" />
                                        <circle cx="66" cy="50" r="3.7" />
                                    </svg>
                                    <span class="button-text">Đăng xuất</span>
                                </button>
        </form>
    </div>
    <div class="profile-vertical-divider"></div>
    <div class="profile-right">
        <div id="profileInfoSection">
            <div class="profile-info-title">Thông tin cá nhân</div>
            <form asp-action="Profile" asp-controller="Account" method="post" class="profile-info-form">
                <div class="profile-info-row">
                    <label>Email</label>
                    <input type="email" value="@Model.Email" readonly />
                </div>
                <div class="profile-info-row">
                    <label>Họ và tên</label>
                    <input asp-for="FullName" />
                </div>
                <div class="profile-info-row">
                    <label>Ngày sinh</label>
                    <input asp-for="DateOfBirth" type="date" />
                </div>
                <div class="profile-info-row">
                    <label>Số điện thoại</label>
                    <input asp-for="PhoneNumber" />
                </div>
                <div class="profile-info-row">
                    <label>Địa chỉ</label>
                    <input asp-for="Address" />
                </div>
                <div class="profile-info-actions">
                    <button type="submit" class="profile-btn">Cập nhật thông tin</button>
                    <a href="/Account/ChangePassword" class="profile-btn secondary">Đổi mật khẩu</a>
                </div>
            </form>
            @if (ViewBag.Success != null)
            {
                <div class="profile-success">@ViewBag.Success</div>
            }
        </div>
        <div id="favoritesSection" style="display:none;">
            <div class="profile-info-title">Sản phẩm yêu thích</div>
            <div id="favoritesContent">
                <div class="profile-section-empty">Chưa có sản phẩm yêu thích</div>
            </div>
        </div>
        <div id="ordersSection" style="display:none;">
            <div class="profile-info-title">Đơn hàng của bạn</div>
            <div id="ordersContent">
                <div class="profile-section-empty">Chưa có đơn hàng nào</div>
            </div>
        </div>
    </div>
</div>

<!-- Avatar Upload Modal -->
<div class="modal fade" id="avatarModal" tabindex="-1" aria-labelledby="avatarModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="avatarModalLabel">Thay đổi ảnh đại diện</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form asp-action="UploadAvatar" asp-controller="Account" method="post" enctype="multipart/form-data" id="avatarForm">
                    <div class="mb-3">
                        <label for="avatar" class="form-label">Chọn ảnh</label>
                        <input type="file" class="form-control" id="avatar" name="avatar" accept="image/*" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                <button type="submit" form="avatarForm" class="btn btn-primary">Thay đổi ảnh</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/profile.js"></script>
    <script src="~/js/theme.js"></script>
} 